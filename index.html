<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>Google Sheets teszt</title>
</head>
<body>
    <h1>Adatok Google Sheets-ből</h1>
    <table border="1" id="adatTabla">
        <thead></thead>
        <tbody></tbody>
    </table>

    <script>
        const SHEET_ID = "1Rh6Udsg6GB27td1egv0HI1234oNz19fbJIXCEH8bv4g";
        const SHEET_NAME = "Sheet1";
        const CSV_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${SHEET_NAME}`;

        fetch(CSV_URL)
            .then(res => res.text())
            .then(csvText => {
                // Az idézőjelek eltávolítása és a sorok feldolgozása
                const rows = csvText.split("\n").map(r => r.split(",").map(c => c.replace(/"/g, "")));
                const table = document.getElementById("adatTabla");
                
                // Fejléc
                const thead = table.querySelector("thead");
                const headRow = document.createElement("tr");
                rows[0].forEach(cell => {
                    const th = document.createElement("th");
                    th.textContent = cell;
                    headRow.appendChild(th);
                });
                thead.appendChild(headRow);

                // Sorok
                const tbody = table.querySelector("tbody");
                rows.slice(1).forEach(row => {
                    const tr = document.createElement("tr");
                    row.forEach(cell => {
                        const td = document.createElement("td");
                        td.textContent = cell;
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                });
            })
            .catch(err => console.error("Hiba a Google Sheet olvasásakor:", err));
    </script>
</body>
</html>